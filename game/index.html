<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>„Ç≤„Éº„É†</title>

  <style>
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic ProN", "Noto Sans JP", sans-serif;
      background-color: #ffffff;
      color: #111;
    }

    a { color: inherit; text-decoration: none; }

    .container {
      max-width: 960px;
      margin: 0 auto;
      padding: 32px 20px 64px;
    }

    header { margin-bottom: 28px; }
    header h1 { font-size: 1.6rem; margin-bottom: 8px; }
    header p { font-size: 0.9rem; color: #555; }

    /* controls */
    .controls {
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      margin: 12px 0 22px;
    }
    .chips { display:flex; flex-wrap: wrap; gap: 8px; }
    .chip {
      padding: 6px 12px;
      border-radius: 999px;
      background:#eee;
      cursor:pointer;
      user-select:none;
      font-size: 0.85rem;
    }
    .chip.active { background:#111; color:#fff; }

    .games {
      display: flex;
      flex-direction: column;
      gap: 32px;
    }

    .game-card {
      border: 1px solid #e5e5e5;
      padding: 20px;
      display: grid;
      grid-template-columns: 160px 1fr;
      gap: 20px;
      background: #fff;
      transition: background-color 0.2s ease;
    }
    .game-card:hover { background-color: #fafafa; }

    .game-card img {
      width: 100%;
      aspect-ratio: 1 / 1;
      object-fit: cover;
      background-color: #ddd;
    }

    .game-info h2 { font-size: 1.2rem; margin: 0 0 8px; }
    .game-info p {
      font-size: 0.9rem;
      color: #555;
      line-height: 1.7;
      margin: 0 0 12px;
    }

    .meta {
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
      margin: 8px 0 12px;
      color:#777;
      font-size: 0.85rem;
    }

    .badge {
      display:inline-block;
      padding: 4px 10px;
      border-radius: 999px;
      background:#eee;
      color:#444;
      font-size: 0.8rem;
      text-decoration: none;
    }
    .badge:hover { background:#e6e6e6; }

    .links {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .links a {
      border: 1px solid #ddd;
      padding: 6px 12px;
      font-size: 0.8rem;
      border-radius: 4px;
    }

    .empty { color:#666; padding: 14px 0; }

    footer {
      margin-top: 80px;
      text-align: center;
      font-size: 0.8rem;
      color: #666;
    }

    @media (max-width: 640px) {
      .game-card { grid-template-columns: 1fr; }
      .game-card img { max-width: 240px; margin: 0 auto; }
      .game-info { text-align: center; }
      .links { justify-content: center; }
      .meta { justify-content: center; }
    }

    @media (min-width: 900px) {
      body { background-color: #f5f5f5; }
      .container { background-color: #ffffff; }
    }
  </style>
</head>

<body>
  <div class="container">

    <header>
      <h1>„Ç≤„Éº„É†</h1>
      <p>ÂÄã‰∫∫Âà∂‰Ωú„Ç≤„Éº„É†„ÅÆÁ¥π‰ªã„Éö„Éº„Ç∏„Åß„Åô„ÄÇ„Éó„É¨„Ç§„ÅØÂ§ñÈÉ®„Çµ„Ç§„Éà„Åã„ÇâË°å„Åà„Åæ„Åô„ÄÇ</p>
    </header>

    <div class="controls">
      <div class="chips" id="chips">
        <div class="chip active" data-world="all">„Åô„Åπ„Å¶</div>
        <div class="chip" data-world="mythland">Á•ûË©±‰∏ñÁïå</div>
        <div class="chip" data-world="mechforest">Ê£Æ„Å®Ê©üÊ¢∞</div>
      </div>
    </div>

    <div class="empty" id="emptyMsg" style="display:none;">Ë©≤ÂΩì„Åô„Çã„Ç≤„Éº„É†„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</div>
    <main class="games" id="games"></main>

    <footer>
      <p><a href="../index.html" style="text-decoration: underline;">„Éà„ÉÉ„Éó„Å∏Êàª„Çã</a></p>
      <p>¬© 2025 Organ All rights reserved</p>
    </footer>

  </div>

  <!-- „Éá„Éº„Çø -->
  <script src="../data/worlds.js"></script>
  <script src="../data/game.js"></script>

  <script>
    const gamesEl = document.getElementById('games');
    const emptyEl = document.getElementById('emptyMsg');
    const chips = document.querySelectorAll('.chip');

    const gamesAll = (window.GAMES || []).slice();
    const worlds = (window.WORLDS || []).slice();
    const worldMap = new Map(worlds.map(w => [w.id, w]));

    let selectedWorld = 'all';

    // „ÉÅ„ÉÉ„ÉóË°®Á§∫„Çí worlds.js „Åã„ÇâËá™ÂãïÁîüÊàê„Åó„Åü„ÅÑÂ†¥Âêà„ÅØ„ÄÅÊ¨°„ÅÆ‰ºöË©±„Åß„ÇÑ„Çå„Åæ„ÅôÔºà‰ªä„ÅØÂõ∫ÂÆö„Åß„ÇÇOKÔºâ

    function render() {
      const list = (selectedWorld === 'all')
        ? gamesAll
        : gamesAll.filter(g => g.worldId === selectedWorld);

      gamesEl.innerHTML = '';
      emptyEl.style.display = (list.length === 0) ? 'block' : 'none';

      list.forEach(item => {
        const card = document.createElement('section');
        card.className = 'game-card';

        const img = document.createElement('img');
        img.src = `../${item.cover}`;
        img.alt = item.title || 'game';
        img.loading = 'lazy';

        const info = document.createElement('div');
        info.className = 'game-info';

        const h2 = document.createElement('h2');
        h2.textContent = item.title || '';

        const meta = document.createElement('div');
        meta.className = 'meta';

        if (item.worldId && worldMap.has(item.worldId)) {
          const w = worldMap.get(item.worldId);
          const aWorld = document.createElement('a');
          aWorld.className = 'badge';
          aWorld.href = `../worlds/world.html?id=${encodeURIComponent(w.id)}`;
          aWorld.textContent = `üåç ${w.name}`;
          meta.appendChild(aWorld);
        }

        const p = document.createElement('p');
        p.textContent = item.description || '';

        const links = document.createElement('div');
        links.className = 'links';

        (item.links || []).forEach(l => {
          const a = document.createElement('a');
          a.href = l.url;
          a.textContent = l.label || 'Link';
          a.target = '_blank';
          a.rel = 'noopener noreferrer';
          links.appendChild(a);
        });

        info.appendChild(h2);
        info.appendChild(meta);
        info.appendChild(p);
        info.appendChild(links);

        card.appendChild(img);
        card.appendChild(info);

        gamesEl.appendChild(card);
      });
    }

    chips.forEach(c => c.addEventListener('click', () => {
      chips.forEach(x => x.classList.remove('active'));
      c.classList.add('active');
      selectedWorld = c.dataset.world;
      render();
    }));

    render();
  </script>
</body>
</html>
